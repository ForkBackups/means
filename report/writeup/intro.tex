\section{Introduction} \label{intro}
\subsection{Moment Closure Methods}

Most biological systems, such as cells, organisms, populations and ecosystems are intricaly complex and non-linear.
For this reason, some aspect of these systems are extremely difficult to understand and predict, both qualitatively and quantitatively\cite{klipp_systems_2013}.
Using explicit models to describe them provide an abstract and extensible
framework which allows to infer state of a system from experimental data.
In addition, models permit to make testable predictions on the behaviour of the system when parameters are modified.
In the last few decades, using mathematical representations of biological interactions has been an increasingly fruitful and wide aspect of biological research.
Many areas of biology, such as ecology, population biology and biochemistry,
use kinetic modelling to describe and understand temporal dynamics of their respective systems.

Deterministic modelling of dynamic systems generally involves listing
interacting agents (species) and decomposing a system in individual processes (\eg{} chemical reactions).
Processes are mathematically described with explicit rate parameters, and \glspl{ode} are used to express the change in the amount of species over time.
Generally, systems are assumed to be homogeneous, and the amount of each species is approximated as a continuous quantity.
This approach has been extremely useful for describing many systems, but it faces severe limitations when modelling small discrete quantities.
For instance, macromolecules in a cell can be present in a very small amount (less than 100).
In this situation, the assumptions of deterministic modelling may fail.
This has been shown to result in quantitative inaccuracy, and, in the worst cases, qualitatively erroneous predictions.


In order to overcome limitations of deterministic modelling, stochastic modelling has been advanced as a solution.
It relies on \gls{cme}, which is a set of differential (or difference) equations providing an \emph{exact} description of a system\cite{kampen_stochastic_2011}.
Except for very simple systems, the \gls{cme} cannot be solved analytically.
However, it is possible to simulate single realisations of the chemical master equation using \gls{gssa}.
If enough (generally several thousands), simulations are performed, very accurate estimations of the system can be obtained.
Despite extensive effort on increasing the efficiency of such simulations, either by describing new algorithms, or by improving implementations,
they remain too slow for certain problems.
In particular, when trying to infer biological parameters from experimental data, according to an explicit model,
it is necessary to perform many simulations.
In extreme cases, such as for \gls{abc}\cite{toni_approximate_2009}, a very large number of simulations are necessary in order to obtain an 
accurate posterior distributions for parameters.
Therefore, for parameter inference, stochastic simulations are unfortunately critically slow and can rarely be used, even for relatively simple systems.

In order to overcome performance limitations of stochastic simulations whist providing accurate enough results, approximations have been used.
\Gls{lna}, for instance, approximates the \gls{cme}
by taking in account only the means (first order raw moments), and the variances and covariances (second order central moments)\cite{komorowski_bayesian_2009}.
This method is valid when the amount of each species is large and for systems with first order reactions
(such as  $a \rightarrow b$, but not $a + c  \rightarrow b$).
Another approach has been to expand the \gls{cme} by expressing central moments in terms of second or third order central moments\cite{gillespie_moment-closure_2009, gomez-uribe_mass_2007}.
Recently, this concept has been generalised to expand the \gls{cme} up to any arbitrary moment order\cite{ale_general_2013}.
This method, \gls{mea}, has shown very promising results, but has not been investigated in detail yet.

To model the changes in concentrations using \gls{mea}, higher order moment are required to express the lower order moments
(\ie{} the $i^{th}$ moment depends on the $(i+1)^{th}$ moment).
This makes the expressions for moments infinitely long, and the \glspl{ode} impossible to solve.
Therefore, a moment closure method is necessary to approximate the higher order moments.
In the original publication\cite{ale_general_2013}, higher order moments were assumed to be zero.
However, if, instead, an assumption is made on the distribution of the species numbers, it is possible
to express any moment in terms of parameters of this distribution\cite{milner_moment_2011}.
Therefore, instead of closing moment expansion with an absolute (scalar) value, it can be closed by expressions in
terms of distribution parameters such as mean and variance, which are lower order moments.
In principle, \emph{a priori} information on the system can help to decide what type of closure is appropriate for a given system.
Preliminary investigation of this ``parametric moment expansion closure'' in the context of MEA has reviled promising preliminary results\cite{lakatos_preparation_2014}.

\gls{mea} being a very recent development, no comprehensive public implementation is available to the community.
An in-house \mat{} package was developed by the authors of the original publication and a \py{} implementation was attempted by last year's MSc students\cite{babtie_moment_2013}.
However, both implementations are still prototypical and mostly undocumented.
 
The aim of our work was to improve and extend existing tools in order to provide a comprehensive implementation of \gls{mea}.
We provide \means{}, a \py{} package for Moment Expansion Approximation, iNference and Simulations.
Our package implement \gls{mea}, but also \gls{gssa} and \gls{lna}.
In addition, moment expansion closure can be performed using Normal, Log-Normal and Gamma distributions as well as the original scalar closure.

In the report herein, we explain which decisions drove the design of the package.
Then, we describe how we have dramatically restructured the original code in order to improve maintainability.
Afterwards, some examples of intended use and tutorials are presented to the illustrate the usability and the scope of \means.
We then demonstrate how we managed to considerably improve performance during development.
Importantly, we further used our package to critically assess \gls{mea}, and address potential limitations.
Finally, an exhaustive documentation for future maintainers and users was printed in the appendix of this document.